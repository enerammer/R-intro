<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Introduction to R: A couple of plots. And making our own functions</title><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" type="text/css" href="../assets/styles.css"><script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="manifest" href="../site.webmanifest"><link rel="mask-icon" href="../safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"></head><body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav library"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="Library Carpentry" src="../assets/images/library-logo.svg"><abbr class="badge badge-light" title="This lesson is in the beta phase, which means that it is ready for teaching by instructors outside of the original author team." style="background-color: #001483; border-radius: 5px">
          <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#polishing-beta-stage" class="external-link alert-link" style="color: #FFF7F1">
            <i aria-hidden="true" class="icon" data-feather="alert-circle" style="border-radius: 5px"></i>
            Beta
          </a>
          <span class="visually-hidden">This lesson is in the beta phase, which means that it is ready for teaching by instructors outside of the original author team.</span>
        </abbr>
        
      </div>
    </div>
    <div class="selector-container">
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='../04-functions-plots.html';">Learner View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav library" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Library Carpentry" src="../assets/images/library-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Introduction to R
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="search button" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Introduction to R
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><hr></ul></li>
      </ul></div>
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled><input class="form-control me-2 searchbox" type="search" placeholder="Search" aria-label="Search"><button class="btn btn-outline-success tablet-search-button" type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="search button"></i>
        </button>
      </fieldset></form>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Introduction to R
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 50%" class="percentage">
    50%
  </div>
  <div class="progress library">
    <div class="progress-bar library" role="progressbar" style="width: 50%" aria-valuenow="50" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../04-functions-plots.html">Learner View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->
      
            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Setup</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="00-intro.html">1. Before we Start</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="01-intro-to-r.html">2. Introduction to R</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="02-starting-with-data.html">3. Starting with Data</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="03-dplyr-tidyr.html">4. Data Wrangling with dplyr and tidyr</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        5. A couple of plots. And making our own functions
        </span>
      </button>
    </div><!--/div.accordion-header-->
        
    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#scatterplots">Scatterplots</a></li>
<li><a href="#boxplots">Boxplots</a></li>
<li><a href="#histograms">Histograms</a></li>
<li><a href="#writing-our-own-functions">Writing our own functions</a></li>
<li><a href="#logical-tests-in-functions">Logical tests in functions</a></li>
<li><a href="#loops">loops</a></li>
<li><a href="#ggplot">ggplot</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="05-whats-next.html">6. What is the next step?</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr></ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width resources"><a href="../instructor/aio.html">See all in one page</a>
            

            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">
            
            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/03-dplyr-tidyr.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/05-whats-next.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/03-dplyr-tidyr.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Data Wrangling with
        </a>
        <a class="chapter-link float-end" href="../instructor/05-whats-next.html" rel="next">
          Next: What is the next... 
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>A couple of plots. And making our own functions</h1>
        <p>Last updated on 2024-03-19 |
        
        <a href="https://github.com/KUBDatalab/R-intro/edit/main/episodes/04-functions-plots.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
        
        
        
        <p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 115 minutes</p>
        
        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="questions:">
<ul><li>How do I create scatterplots, boxplots, and barplots?</li>
<li>How can I define my own functions?</li>
</ul></div>
<div class="objectives:">
<ul><li>Produce scatter plots and boxplots using Base R.</li>
<li>Write your own function</li>
<li>Write loops to repeat calculations</li>
<li>Use logical tests in loops</li>
</ul></div>
<p>In case you have made changes to the original object we made. We read
in the data in a new object</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">movieSerie_plotting</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"data/movieSerie.csv"</span>, na <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"NA"</span>, <span class="st">"NULL"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Rows: 5850 Columns: 14
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (7): id, title, type, genre, description, age_certification, imdb_id
dbl (7): release_year, runtime, seasons, imdb_score, imdb_votes, tmdb_popula...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<section id="scatterplots"><h2 class="section-heading">Scatterplots<a class="anchor" aria-label="anchor" href="#scatterplots"></a>
</h2>
<hr class="half-width"><p>Scatterplots visualizes the relation between two variables in the
dataset, by plotting individual observations in a two-dimensional graph,
with the position in the x,y-plane defined by the values of the two
variables.</p>
<p>The default plot function in Base R takes two vectors, one containing
the values of the x-axis and one containing the values for the y-axis.
Here we use the $-notation:</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot</span><span class="op">(</span><span class="va">movieSerie_plotting</span><span class="op">$</span><span class="va">release_year</span>, <span class="va">movieSerie_plotting</span><span class="op">$</span><span class="va">imdb_score</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/04-functions-plots-rendered-first-scatterplot-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Scatterplots are useful for showing that sort for relationships in
the data. Here it does not appear that the correlation exists; there is
no clear trend.</p>
<p>We might want to adjust the labels on the axes, and add a main
title:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot</span><span class="op">(</span><span class="va">movieSerie_plotting</span><span class="op">$</span><span class="va">release_year</span>, <span class="va">movieSerie_plotting</span><span class="op">$</span><span class="va">imdb_score</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Relation between release date and their imdb_score"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Release year"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"imdb score"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/04-functions-plots-rendered-unnamed-chunk-1-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></section><section id="boxplots"><h2 class="section-heading">Boxplots<a class="anchor" aria-label="anchor" href="#boxplots"></a>
</h2>
<hr class="half-width"><p>We can use boxplots to visualize the distribution of number of
imdb_score for genre:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">boxplot</span><span class="op">(</span><span class="va">movieSerie_plotting</span><span class="op">$</span><span class="va">imdb_score</span><span class="op">~</span><span class="va">movieSerie_plotting</span><span class="op">$</span><span class="va">genre</span><span class="op">)</span></span></code></pre>
</div>
<p><img src="../fig/04-functions-plots-rendered-unnamed-chunk-2-1.png" style="display: block; margin: auto;" class="figure">
Two new things happens here. First, we are using a new way of telling
the plot function what relationship we want to visualise. The function
notation y~x, tells the boxplot function that we want to visualise y as
a function of x. In this case we want to visualise the number of people,
as af function of the wall type. Secondly, we use a boxplot. A boxplots
shows the distribution of the values on the y-axis. The median value is
indicated by the solid bar. The box encapsulates 50% of the
observations. Its upper and lower borders represents the interquartile
range (IQR). The whiskers on the plot - here only the upper whiskers are
shown due to the nature of the data, represents the range of the data.
The distance from the upper part of the box, to the whisker is 1.5 times
the interquartile range. The dots that we see for muddaub and sunbricks
are outliers. Observations that lies so far from the rest of the
observations, that we consider them as outliers.</p>
<p>Depending on the data, and the nature of the analyses we are going to
do, outliers are either very interesting, or something that we can
ignore.</p>
</section><section id="histograms"><h2 class="section-heading">Histograms<a class="anchor" aria-label="anchor" href="#histograms"></a>
</h2>
<hr class="half-width"><p>Another useful plottype are histograms.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">hist</span><span class="op">(</span><span class="va">movieSerie_plotting</span><span class="op">$</span><span class="va">runtime</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/04-functions-plots-rendered-unnamed-chunk-3-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Histograms counts the number of observations in our data, that lies
between two values. Here the “breaks” between the values on the x-axis
corresponds nicely to the number of people, but they do not have to.</p>
</section><section id="writing-our-own-functions"><h2 class="section-heading">Writing our own functions<a class="anchor" aria-label="anchor" href="#writing-our-own-functions"></a>
</h2>
<hr class="half-width"><p>When calculating an average of several values, we do two things.
First we count how many values there are. Then we sum all the values,
and divides the sum by the number of values. Rather than writing R-code
for each of these three operations, we use the mean() function, where
other more experienced programmers have written the code.</p>
<p>We can write our own functions, where we collect several operations
into one function.</p>
<p>Functions in R are defined in this way:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">function_name</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">temporary_result_1</span> <span class="op">&lt;-</span> <span class="fu">some_function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>  <span class="va">temporary_result_2</span> <span class="op">&lt;-</span> <span class="fu">some_other_function</span><span class="op">(</span><span class="va">temporary_result_1</span><span class="op">)</span></span>
<span>  <span class="fu">yet_another_function</span><span class="op">(</span><span class="va">temporary_result_2</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<p>function_name defines the name of our function.</p>
<p>function(x) tells R that we are defining a function, that takes X as
input. We can then use that x as input to calculations or other
functions within our own function.</p>
<p>Between the curly braces {}, we define what we want our function to
do. We assign the result of some_function(x) to a temporary result, use
that as the input to a second function, and the result of that as the
input to a third function. The result of the last calculation we do,
will be returned as the output of our function.</p>
<div id="exercise" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise:<a class="anchor" aria-label="anchor" href="#exercise"></a>
</h3>
<div class="callout-content">
<p>Write a function that calculates the average value of a numeric
vector, takes the square root of that average, and returns the
result</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<p>One way to do this would be:</p>
<p>root_mean &lt;- function(x){ sqrt(mean(x, na.rm=T)) }</p>
<p>Another way could be:</p>
<p>root_mean &lt;- function(x){ temp &lt;- mean(x, na.rm =T)&gt; result
&lt;- sqrt(temp) result }</p>
</div>
</div>
</div>
</div>
</section><section id="logical-tests-in-functions"><h2 class="section-heading">Logical tests in functions<a class="anchor" aria-label="anchor" href="#logical-tests-in-functions"></a>
</h2>
<hr class="half-width"><p>Some times we want to do something different to the data, depending
on the data. We can control the flow of the code using the if()
construction.</p>
<p>As an example: if(x&lt;10){ print(“X is smaller than 10”) }else{
print(“x is larger than 10”) }</p>
<p>The if() function will run the code provided in the curly braces {},
if, and only if, the expression in the paranthesis is true. If x is 11,
x is not<br>
smaller than 10, and the first print function will not be executed.</p>
<p>The else-part is not requiered, but normally we will have to execute
some other code if the statement in the if-function is not true. In this
case if x is 11, the first print-function will not be executed, but the
second will.</p>
<p>We use logical tests to handle data differently, depending on some
characteristics of the data.</p>
</section><section id="loops"><h2 class="section-heading">loops<a class="anchor" aria-label="anchor" href="#loops"></a>
</h2>
<hr class="half-width"><p>Loops are constructs we use to do the same operations on lots of
data.</p>
<div class="section level3">
<h3 id="for-loops">for loops<a class="anchor" aria-label="anchor" href="#for-loops"></a></h3>
<p>For loops are constructs used to apply one or more functions on a
series of data.</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu">sqrt</span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span>
<span>  <span class="fu">print</span><span class="op">(</span><span class="va">temp</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1
[1] 1.414214
[1] 1.732051
[1] 2
[1] 2.236068
[1] 2.44949
[1] 2.645751
[1] 2.828427
[1] 3
[1] 3.162278</code></pre>
</div>
<p>will take every value in the vector 1:10, the digits 1 to 10, one by
one, assign it to a temporary variable i and run the code we write in
the curly braces. Here the for-loop will take all numbers from 1 to 10,
calculate the squareroot of them. The result is assigned to another
temporary variable “temp” and then temp is printed.</p>
<div class="section level4">
<h4 id="danger-will-robinson">Danger Will Robinson<a class="anchor" aria-label="anchor" href="#danger-will-robinson"></a></h4>
<p>As a general rule, R does not handle loops very efficiently. This is
a simple loop, operating on only 10 values, and we wont notice the
difference in speed.</p>
<p>But we can measure it.</p>
<p>The Sys.time() function will tell us what time our computer thinks it
is. If we run that just before, and just after our loop, we can
calculate how long it took to run.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tic</span> <span class="op">&lt;-</span> <span class="fu">Sys.time</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">1000</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu">sqrt</span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span>
<span>  <span class="fu">print</span><span class="op">(</span><span class="va">temp</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">toc</span> <span class="op">&lt;-</span> <span class="fu">Sys.time</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">for_time</span> <span class="op">&lt;-</span> <span class="va">toc</span> <span class="op">-</span> <span class="va">tic</span></span></code></pre>
</div>
<p>A more efficient way to calculate the square root of the numbers from
1 to 10 would be use the fact that sqrt() is a vectorized function that
will calculate the square root of every element in a vector used as
input to it:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tic</span> <span class="op">&lt;-</span> <span class="fu">Sys.time</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">sqrt</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">toc</span> <span class="op">&lt;-</span> <span class="fu">Sys.time</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">vect_time</span> <span class="op">&lt;-</span> <span class="va">toc</span> <span class="op">-</span> <span class="va">tic</span></span>
<span><span class="va">vect_time</span></span></code></pre>
</div>
<p>And we can then compare how much faster the latter vectorized
solution is.</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">as.numeric</span><span class="op">(</span><span class="va">for_time</span><span class="op">)</span><span class="op">/</span><span class="fu">as.numeric</span><span class="op">(</span><span class="va">vect_time</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 6.747895</code></pre>
</div>
<p>More than double as fast! To be fair most of the time is spent
outputting the results, but as a general rule utilizing the vectorized
nature of functions is faster than writing loops. But that is not always
a luxury we have.</p>
</div>
</div>
<div class="section level3">
<h3 id="while-loops">while loops<a class="anchor" aria-label="anchor" href="#while-loops"></a></h3>
<p>While loops are loops that execute the code - as long as some
criterium is satisfied.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="kw">while</span><span class="op">(</span><span class="va">i</span> <span class="op">&lt;=</span> <span class="fl">10</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="fu">print</span><span class="op">(</span><span class="fu">sqrt</span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">i</span> <span class="op">&lt;-</span> <span class="va">i</span> <span class="op">+</span> <span class="fl">1</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 1
[1] 1.414214
[1] 1.732051
[1] 2
[1] 2.236068
[1] 2.44949
[1] 2.645751
[1] 2.828427
[1] 3
[1] 3.162278</code></pre>
</div>
<p>This loop structure does the exact same as the two previous examples.
Here we need to assign an initial value i, and then our while loop will
execute the code within the curly braces, as long as i is smaller than
or equal to 10. It is important to remember to increment the value of i
- otherwise i will always be 1, and therefore always smaller than 10.
And the loop will never stop.</p>
</div>
</section><section id="ggplot"><h2 class="section-heading">ggplot<a class="anchor" aria-label="anchor" href="#ggplot"></a>
</h2>
<hr class="half-width"><p>The plotting functions in R produce nice clean plots without any
fancy details. That is generally a good thing, we want to maximize the
information per ink in our plots.</p>
<p>However, we are limited in the types of plots we can make, and
sometimes we just want a bit more color.</p>
<p>Enter ggplot2.</p>
<p>ggplot2 is a package designed to work well with the packages we have
already encountered. It produces plots in a structured way, and comes
with a lot of extensions, that enables us to plot almost anything.</p>
<p>The basic structure of ggplots are:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">data</span>, mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>ggplot takes some data. Typically we will provide the data using the
pipe: <code>%&gt;%</code></p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span>mapping <span class="op">=</span> <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">x</span>, y<span class="op">=</span><span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<p>The <code>mapping</code> argument tells ggplot which variables in our
data should be mapped to the x- and y-axes in our plot.</p>
<p>That in itself will not produce much of a plot. We need to tell
ggplot which type of plot we want.</p>
<p>We do that by adding a <code>geom_</code> function. Here we have
added <code>geom_point</code> which produces a scatter-plot. Other
functions are more intuitively named. <code>geom_col</code> gives us a
column-plot, <code>geom_histogram</code> a histogram etc.</p>
<p>Let us try to make a histogram like we saw earlier:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interviews_plotting</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">no_membrs</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">ERROR<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="error" tabindex="0"><code>Error in eval(expr, envir, enclos): object 'interviews_plotting' not found</code></pre>
</div>
<p>It looks different, and we get a warning about <code>binwidth</code>.
geom_histogram automatically chooses 30 bins for us, and that is
normally not the right number.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul><li>Boxplots are useful for visualizing the distribution of a continuous
variable.</li>
<li>Barplots are useful for visualizing categorical data.</li>
<li>Functions allows you to repeat the same set of operations again and
again.</li>
<li>Loops allows you to apply the same function to lots of data.</li>
<li>Logical tests allow you to apply different calculations on different
sets of data.</li>
</ul></div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/03-dplyr-tidyr.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/05-whats-next.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/03-dplyr-tidyr.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Data Wrangling with
        </a>
        <a class="chapter-link float-end" href="../instructor/05-whats-next.html" rel="next">
          Next: What is the next... 
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/KUBDatalab/R-intro/edit/main/episodes/04-functions-plots.Rmd" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://github.com/KUBDatalab/R-intro/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/KUBDatalab/R-intro/" class="external-link">Source</a></p>
				<p><a href="https://github.com/KUBDatalab/R-intro/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:kubdatalab@kb.dk">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.3" class="external-link">sandpaper (0.16.3)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.4" class="external-link">pegboard (0.7.4)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.1" class="external-link">varnish (1.0.1)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://KUBDatalab.github.io/R-intro/instructor/04-functions-plots.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries, KUB Datalab",
  "name": "A couple of plots. And making our own functions",
  "creativeWorkStatus": "active",
  "url": "https://KUBDatalab.github.io/R-intro/instructor/04-functions-plots.html",
  "identifier": "https://KUBDatalab.github.io/R-intro/instructor/04-functions-plots.html",
  "dateCreated": "2024-02-14",
  "dateModified": "2024-03-19",
  "datePublished": "2024-03-19"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code --></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

